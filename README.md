# Blog API

API для блога с поддержкой постов, комментариев и пользователей.

## Функциональность

- Система пользователей с ролями (пользователь/редактор/администратор)
- Аутентификация на основе JWT-токенов
- Управление постами (CRUD) с поддержкой тегов
- Комментарии к постам с возможностью вложенных ответов
- Разграничение прав доступа
- Пагинация и фильтрация
- Поддержка URL-friendly slug для постов

## Технический стек

- Python 3.10+
- FastAPI 0.95+
- MongoDB (через Motor для асинхронной работы)
- Pydantic 2.0+
- JWT для аутентификации

## Установка и запуск

1. Клонировать репозиторий
2. Создать виртуальное окружение:
   ```
   python -m venv venv
   source venv/bin/activate  # для Linux/macOS
   venv\Scripts\activate     # для Windows
   ```
3. Установить зависимости:
   ```
   pip install -r requirements.txt
   ```
4. Создать файл `.env` на основе `.env.example`
5. Запустить MongoDB
6. Запустить приложение:
   ```
   python main.py
   ```

После запуска API будет доступно по адресу http://localhost:8000

## API Endpoints

### Аутентификация

- `POST /api/auth/register` - Регистрация нового пользователя
- `POST /api/auth/login` - Авторизация и получение JWT токена
- `POST /api/auth/refresh-token` - Обновление JWT токена
- `POST /api/auth/change-password` - Изменение пароля

### Пользователи

- `GET /api/users/me` - Получение информации о текущем пользователе
- `GET /api/users/me/stats` - Получение статистики текущего пользователя
- `PUT /api/users/me` - Обновление информации о текущем пользователе
- `GET /api/users/me/posts` - Получение постов текущего пользователя
- `GET /api/users/me/comments` - Получение комментариев текущего пользователя
- `GET /api/users` - Получение списка пользователей
- `GET /api/users/{user_id}` - Получение информации о пользователе
- `GET /api/users/{user_id}/stats` - Получение статистики пользователя
- `PUT /api/users/{user_id}` - Обновление информации о пользователе (только для администраторов)
- `DELETE /api/users/{user_id}` - Удаление пользователя (только для администраторов)

### Посты

- `POST /api/posts` - Создание нового поста
- `GET /api/posts` - Получение списка постов
- `GET /api/posts/{post_id}` - Получение поста по ID
- `GET /api/posts/slug/{slug}` - Получение поста по slug
- `PUT /api/posts/{post_id}` - Обновление поста
- `DELETE /api/posts/{post_id}` - Удаление поста
- `GET /api/posts/{post_id}/comments` - Получение комментариев к посту

### Комментарии

- `POST /api/comments` - Создание нового комментария
- `GET /api/comments/{comment_id}` - Получение комментария по ID
- `GET /api/comments/{comment_id}/replies` - Получение комментария с ответами
- `PUT /api/comments/{comment_id}` - Обновление комментария
- `DELETE /api/comments/{comment_id}` - Удаление комментария

## Роли пользователей

- **USER** - базовые права: создание постов и комментариев, редактирование и удаление собственного контента
- **EDITOR** - дополнительные права: редактирование и удаление любых постов
- **ADMIN** - полные права: управление пользователями, модерация контента

## Примеры запросов

### Создание поста

```
POST /api/posts
{
  "title": "Мой первый пост",
  "content": "Содержимое поста...",
  "summary": "Краткое описание",
  "tags": ["тег1", "тег2"],
  "status": "published"
}
```

### Получение постов с фильтрацией

```
GET /api/posts?tag=технологии&status=published&limit=10&offset=0
```

### Создание комментария

```
POST /api/comments
{
  "content": "Отличный пост!",
  "post_id": "post_id_here"
}
```

### Создание ответа на комментарий

```
POST /api/comments
{
  "content": "Спасибо за комментарий!",
  "post_id": "post_id_here",
  "parent_id": "comment_id_here"
}
```
